<!DOCTYPE html>
<html>
<head>
    <title>Social Media Automation</title>
</head>
<body>
    <h1>Social Media Automation</h1>
    <p>A tool for automating social media content posting across multiple platforms.</p>
    
    <!-- TikTok Login Button Container -->
    <div id="tiktok-login-container">
        <button onclick="loginWithTikTok()">Login with TikTok</button>
    </div>
    
    <!-- Upload Form (initially hidden) -->
    <div id="upload-form" style="display: none;">
        <h2>Upload Video to TikTok</h2>
        <form id="video-upload-form">
            <input type="file" id="video-file" accept="video/*" required><br><br>
            <input type="text" id="description" placeholder="Video description"><br><br>
            <input type="text" id="hashtags" placeholder="Hashtags (comma separated)"><br><br>
            <select id="visibility">
                <option value="private">Only me</option>
                <option value="public">Public</option>
            </select><br><br>
            <button type="submit">Upload Video</button>
        </form>
    </div>

    <ul>
        <li><a href="TERMS">Terms of Service</a></li>
        <li><a href="PRIVACY">Privacy Policy</a></li>
    </ul>

    <script>
        function loginWithTikTok() {
            const clientKey = "awdmgl4x0u4626up";
            const redirectUri = "https://nassermendes.github.io/social-media-automation/callback";
            const scope = "user.info.basic,video.upload";
            const state = Math.random().toString(36).substring(7);
            
            // Construct TikTok OAuth URL
            const authUrl = "https://www.tiktok.com/auth/authorize/" +
                "?client_key=" + clientKey +
                "&scope=" + scope +
                "&response_type=code" +
                "&redirect_uri=" + encodeURIComponent(redirectUri) +
                "&state=" + state;
            
            // Redirect to TikTok auth page
            window.location.href = authUrl;
        }

        // Check if we are returning from TikTok auth
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get("code");
            if (code) {
                console.log("Received auth code:", code);
                // Store the auth code
                localStorage.setItem("tiktok_auth_code", code);
                // Show the upload form
                document.getElementById("upload-form").style.display = "block";
                // Hide the login button
                document.getElementById("tiktok-login-container").style.display = "none";
            }
        };
    </script>
</body>
</html>
